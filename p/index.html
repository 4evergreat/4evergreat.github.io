<!DOCTYPE html>
<html lang="zh-cn">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='typora基本语法 1.层级标题： 1 格式：# &#43; space &#43; 自定义字符 ​ 其中#号的数量代表了标题的层级，单个#为最大的标题。“#” 号与自定义标题字符之'><title></title>

<link rel='canonical' href='http://localhost:1313/p/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content=''>
<meta property='og:description' content='typora基本语法 1.层级标题： 1 格式：# &#43; space &#43; 自定义字符 ​ 其中#号的数量代表了标题的层级，单个#为最大的标题。“#” 号与自定义标题字符之'>
<meta property='og:url' content='http://localhost:1313/p/'>
<meta property='og:site_name' content='alwaysGreat&#39;s blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' />
<meta name="twitter:title" content="">
<meta name="twitter:description" content="typora基本语法 1.层级标题： 1 格式：# &#43; space &#43; 自定义字符 ​ 其中#号的数量代表了标题的层级，单个#为最大的标题。“#” 号与自定义标题字符之">
    <link rel="shortcut icon" href="/logo/image8.png" />

  

<style>
     
    :root {
        --article-font-family: "Merriweather", var(--base-font-family);
    }
</style>

<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap";
    
        customFont.type = "text/css";
        customFont.rel = "stylesheet";
    
        document.head.appendChild(customFont);
    }());
</script>
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="http://localhost:1313/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>返回</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/"></a>
    </h2>

    </div>
</header>

    <section class="article-content">
    <h1 id="数据库开发-mysql">数据库开发-MySQL
</h1><h1 id="1-多表查询">1. 多表查询
</h1><h2 id="11-概述">1.1 概述
</h2><h3 id="111-数据准备">1.1.1 数据准备
</h3><p>SQL脚本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">#建议：创建新的数据库
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">create</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">db04</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">db04</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 部门表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="nf">tb_dept</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="k">unsigned</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="kp">auto_increment</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;主键ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;部门名称&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">create_time</span><span class="w"> </span><span class="kt">datetime</span><span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;创建时间&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">update_time</span><span class="w"> </span><span class="kt">datetime</span><span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;修改时间&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;部门表&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 部门表测试
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="nf">tb_dept</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">create_time</span><span class="p">,</span><span class="w"> </span><span class="n">update_time</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;学工部&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">now</span><span class="p">(),</span><span class="w"> </span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;教研部&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">now</span><span class="p">(),</span><span class="w"> </span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;咨询部&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">now</span><span class="p">(),</span><span class="w"> </span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;就业部&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">now</span><span class="p">(),</span><span class="w"> </span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;人事部&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">now</span><span class="p">(),</span><span class="w"> </span><span class="nf">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 员工表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="nf">tb_emp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w">          </span><span class="kt">int</span><span class="w"> </span><span class="k">unsigned</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="kp">auto_increment</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">username</span><span class="w">    </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">      </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;用户名&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">password</span><span class="w">    </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;123456&#39;</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;密码&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">name</span><span class="w">        </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">      </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;姓名&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">gender</span><span class="w">      </span><span class="kt">tinyint</span><span class="w"> </span><span class="k">unsigned</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;性别, 说明: 1 男, 2 女&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">image</span><span class="w">       </span><span class="kt">varchar</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;图像&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">job</span><span class="w">         </span><span class="kt">tinyint</span><span class="w"> </span><span class="k">unsigned</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;职位, 说明: 1 班主任,2 讲师, 3 学工主管, 4 教研主管, 5 咨询师&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">entrydate</span><span class="w">   </span><span class="kt">date</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;入职时间&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">dept_id</span><span class="w">     </span><span class="kt">int</span><span class="w"> </span><span class="k">unsigned</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;部门ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">create_time</span><span class="w"> </span><span class="kt">datetime</span><span class="w">         </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;创建时间&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">update_time</span><span class="w"> </span><span class="kt">datetime</span><span class="w">         </span><span class="k">not</span><span class="w"> </span><span class="no">null</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;修改时间&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">comment</span><span class="w"> </span><span class="s1">&#39;员工表&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 员工表测试数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="nf">tb_emp</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">job</span><span class="p">,</span><span class="w"> </span><span class="n">entrydate</span><span class="p">,</span><span class="n">dept_id</span><span class="p">,</span><span class="w"> </span><span class="n">create_time</span><span class="p">,</span><span class="w"> </span><span class="n">update_time</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;jinyong&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;金庸&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;1.jpg&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;2000-01-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;zhangwuji&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;张无忌&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2.jpg&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;yangxiao&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;杨逍&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;3.jpg&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;2008-05-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;weiyixiao&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;韦一笑&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;4.jpg&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;2007-01-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;changyuchun&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;常遇春&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;5.jpg&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;2012-12-05&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;xiaozhao&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;小昭&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;6.jpg&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;2013-09-05&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;jixiaofu&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;纪晓芙&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;7.jpg&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2005-08-01&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s1">&#39;zhouzhiruo&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;周芷若&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;8.jpg&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2014-11-09&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;dingminjun&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;丁敏君&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;9.jpg&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2011-03-11&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;zhaomin&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;赵敏&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;10.jpg&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;2013-09-05&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="s1">&#39;luzhangke&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;鹿杖客&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;11.jpg&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;2007-02-01&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="s1">&#39;hebiweng&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;鹤笔翁&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;12.jpg&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;2008-08-18&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="s1">&#39;fangdongbai&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;方东白&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;13.jpg&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;2012-11-01&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="s1">&#39;zhangsanfeng&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;张三丰&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;14.jpg&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;2002-08-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="s1">&#39;yulianzhou&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;俞莲舟&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;15.jpg&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;2011-05-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="s1">&#39;songyuanqiao&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;宋远桥&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;16.jpg&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;2007-01-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">()),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="s1">&#39;chenyouliang&#39;</span><span class="p">,</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="s1">&#39;陈友谅&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;17.jpg&#39;</span><span class="p">,</span><span class="no">NULL</span><span class="p">,</span><span class="s1">&#39;2015-03-21&#39;</span><span class="p">,</span><span class="no">NULL</span><span class="p">,</span><span class="nf">now</span><span class="p">(),</span><span class="nf">now</span><span class="p">());</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="112-介绍">1.1.2 介绍
</h3><p>多表查询：查询时从多张表中获取所需数据</p>
<blockquote>
<p>单表查询的SQL语句：select  字段列表  from  表名;</p>
<p>那么要执行多表查询，只需要使用逗号分隔多张表即可，如： select   字段列表  from  表1, 表2;</p>
</blockquote>
<p>查询用户表和部门表中的数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w">  </span><span class="n">tb_emp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20220901093654673.png" alt="image-20220901093654673"  /></p>
<p>此时,我们看到查询结果中包含了大量的结果集，总共85条记录，而这其实就是员工表所有的记录(17行)与部门表所有记录(5行)的所有组合情况，这种现象称之为笛卡尔积。</p>
<p>笛卡尔积：笛卡尔乘积是指在数学中，两个集合(A集合和B集合)的所有组合情况。</p>
<p><img src="/assets/image-20221207155509696.png" alt="image-20221207155509696"  /></p>
<blockquote>
<p>在多表查询时，需要消除无效的笛卡尔积，只保留表关联部分的数据</p>
</blockquote>
<p><img src="/assets/image-20220901093756992.png" alt=""  /></p>
<p>在SQL语句中，如何去除无效的笛卡尔积呢？只需要给多表查询加上连接查询的条件即可。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207164518904.png" alt="image-20221207164518904"  /></p>
<blockquote>
<p>由于id为17的员工，没有dept_id字段值，所以在多表查询时，根据连接查询的条件并没有查询到。</p>
</blockquote>
<h3 id="113-分类">1.1.3 分类
</h3><p>多表查询可以分为：</p>
<ol>
<li>
<p>连接查询</p>
<ul>
<li>内连接：相当于查询A、B交集部分数据</li>
</ul>
<p><img src="/assets/image-20221207165446062.png" alt="image-20221207165446062"  /></p>
</li>
<li>
<p>外连接</p>
<ul>
<li>
<p>左外连接：查询左表所有数据(包括两张表交集部分数据)</p>
</li>
<li>
<p>右外连接：查询右表所有数据(包括两张表交集部分数据)</p>
</li>
</ul>
</li>
<li>
<p>子查询</p>
</li>
</ol>
<h2 id="12-内连接">1.2 内连接
</h2><p>内连接查询：查询两表或多表中交集部分数据。</p>
<p>内连接从语法上可以分为：</p>
<ul>
<li>
<p>隐式内连接</p>
</li>
<li>
<p>显式内连接</p>
</li>
</ul>
<p>隐式内连接语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w">  </span><span class="err">字段列表</span><span class="w">   </span><span class="k">from</span><span class="w">   </span><span class="err">表</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="err">表</span><span class="mi">2</span><span class="w">   </span><span class="k">where</span><span class="w">  </span><span class="err">条件</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>显式内连接语法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w">  </span><span class="err">字段列表</span><span class="w">   </span><span class="k">from</span><span class="w">   </span><span class="err">表</span><span class="mi">1</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="p">]</span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="err">表</span><span class="mi">2</span><span class="w">  </span><span class="k">on</span><span class="w">  </span><span class="err">连接条件</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>案例：查询员工的姓名及所属的部门名称</p>
<ul>
<li>隐式内连接实现</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="c1">-- 分别查询两张表中的数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="c1">-- 关联两张表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">where</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w"> </span><span class="c1">-- 消除笛卡尔积
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>显式内连接实现</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tb_dept</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tb_dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207173435289.png" alt="image-20221207173435289"  /></p>
<p>多表查询时给表起别名：</p>
<ul>
<li>
<p>tableA  as  别名1  ,  tableB  as  别名2 ;</p>
</li>
<li>
<p>tableA  别名1  ,  tableB  别名2 ;</p>
</li>
</ul>
<p><img src="/assets/image-20221207174234522.png" alt="image-20221207174234522"  /></p>
<p>使用了别名的多表查询：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">dept</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="n">emp</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="n">dept</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">on</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意事项:</p>
<p>一旦为表起了别名，就不能再使用表名来指定对应的字段了，此时只能够使用别名来指定字段。</p>
</blockquote>
<h2 id="13-外连接">1.3 外连接
</h2><p>外连接分为两种：左外连接 和 右外连接。</p>
<p>左外连接语法结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w">  </span><span class="err">字段列表</span><span class="w">   </span><span class="k">from</span><span class="w">   </span><span class="err">表</span><span class="mi">1</span><span class="w">  </span><span class="k">left</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="p">]</span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="err">表</span><span class="mi">2</span><span class="w">  </span><span class="k">on</span><span class="w">  </span><span class="err">连接条件</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>左外连接相当于查询表1(左表)的所有数据，当然也包含表1和表2交集部分的数据。</p>
</blockquote>
<p>右外连接语法结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w">  </span><span class="err">字段列表</span><span class="w">   </span><span class="k">from</span><span class="w">   </span><span class="err">表</span><span class="mi">1</span><span class="w">  </span><span class="k">right</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="p">]</span><span class="w">  </span><span class="k">join</span><span class="w"> </span><span class="err">表</span><span class="mi">2</span><span class="w">  </span><span class="k">on</span><span class="w">  </span><span class="err">连接条件</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>右外连接相当于查询表2(右表)的所有数据，当然也包含表1和表2交集部分的数据。</p>
</blockquote>
<p>案例：查询员工表中所有员工的姓名, 和对应的部门名称</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 左外连接：以left join关键字左边的表为主表，查询主表中所有数据，以及和主表匹配的右边表中的数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">dept</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">emp</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dept</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">on</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207181204792.png" alt="image-20221207181204792"  /></p>
<p>案例：查询部门表中所有部门的名称, 和对应的员工名称</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 右外连接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">dept</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">emp</span><span class="w"> </span><span class="k">right</span><span class="w"> </span><span class="k">join</span><span class="w">  </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dept</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">on</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dept</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207181048208.png" alt="image-20221207181048208"  /></p>
<blockquote>
<p>注意事项：</p>
<p>左外连接和右外连接是可以相互替换的，只需要调整连接查询时SQL语句中表的先后顺序就可以了。而我们在日常开发使用时，更偏向于左外连接。</p>
</blockquote>
<h2 id="14-子查询">1.4 子查询
</h2><h3 id="141-介绍">1.4.1 介绍
</h3><p>SQL语句中嵌套select语句，称为嵌套查询，又称子查询。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">  </span><span class="o">*</span><span class="w">  </span><span class="k">FROM</span><span class="w">   </span><span class="n">t1</span><span class="w">   </span><span class="k">WHERE</span><span class="w">  </span><span class="n">column1</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="k">SELECT</span><span class="w">  </span><span class="n">column1</span><span class="w">  </span><span class="k">FROM</span><span class="w">  </span><span class="n">t2</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>子查询外部的语句可以是insert / update / delete / select 的任何一个，最常见的是 select。</p>
</blockquote>
<p>根据子查询结果的不同分为：</p>
<ol>
<li>
<p>标量子查询（子查询结果为单个值[一行一列]）</p>
</li>
<li>
<p>列子查询（子查询结果为一列，但可以是多行）</p>
</li>
<li>
<p>行子查询（子查询结果为一行，但可以是多列）</p>
</li>
<li>
<p>表子查询（子查询结果为多行多列[相当于子查询结果是一张表]）</p>
</li>
</ol>
<p>子查询可以书写的位置：</p>
<ol>
<li>where之后</li>
<li>from之后</li>
<li>select之后</li>
</ol>
<h3 id="142-标量子查询">1.4.2 标量子查询
</h3><p>子查询返回的结果是单个值(数字、字符串、日期等)，最简单的形式，这种子查询称为标量子查询。</p>
<p>常用的操作符： =   &lt;&gt;   &gt;    &gt;=    &lt;   &lt;=</p>
<p>案例1：查询&quot;教研部&quot;的所有员工信息</p>
<blockquote>
<p>可以将需求分解为两步：</p>
<ol>
<li>查询 &ldquo;教研部&rdquo; 部门ID</li>
<li>根据 &ldquo;教研部&rdquo; 部门ID，查询员工信息</li>
</ol>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 1.查询&#34;教研部&#34;部门ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;教研部&#39;</span><span class="p">;</span><span class="w">    </span><span class="c1">#查询结果：2
</span></span></span><span class="line"><span class="cl"><span class="c1">-- 2.根据&#34;教研部&#34;部门ID, 查询员工信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 合并出上两条SQL语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;教研部&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207202215946.png" alt="image-20221207202215946"  /></p>
<p>案例2：查询在 &ldquo;方东白&rdquo; 入职之后的员工信息</p>
<blockquote>
<p>可以将需求分解为两步：</p>
<ol>
<li>查询 方东白 的入职日期</li>
<li>查询 指定入职日期之后入职的员工信息</li>
</ol>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 1.查询&#34;方东白&#34;的入职日期
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;方东白&#39;</span><span class="p">;</span><span class="w">     </span><span class="c1">#查询结果：2012-11-01
</span></span></span><span class="line"><span class="cl"><span class="c1">-- 2.查询指定入职日期之后入职的员工信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;2012-11-01&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 合并以上两条SQL语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;方东白&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207203000445.png" alt="image-20221207203000445"  /></p>
<h3 id="143-列子查询">1.4.3 列子查询
</h3><p>子查询返回的结果是一列(可以是多行)，这种子查询称为列子查询。</p>
<p>常用的操作符：</p>
<table>
<thead>
<tr>
<th><strong>操作符</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>IN</td>
<td>在指定的集合范围之内，多选一</td>
</tr>
<tr>
<td>NOT IN</td>
<td>不在指定的集合范围之内</td>
</tr>
</tbody>
</table>
<p>案例：查询&quot;教研部&quot;和&quot;咨询部&quot;的所有员工信息</p>
<blockquote>
<p>分解为以下两步：</p>
<ol>
<li>查询 &ldquo;销售部&rdquo; 和 &ldquo;市场部&rdquo; 的部门ID</li>
<li>根据部门ID, 查询员工信息</li>
</ol>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 1.查询&#34;销售部&#34;和&#34;市场部&#34;的部门ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;教研部&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;咨询部&#39;</span><span class="p">;</span><span class="w">    </span><span class="c1">#查询结果：3,2
</span></span></span><span class="line"><span class="cl"><span class="c1">-- 2.根据部门ID, 查询员工信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">dept_id</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 合并以上两条SQL语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">dept_id</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;教研部&#39;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;咨询部&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207203620472.png" alt="image-20221207203620472"  /></p>
<h3 id="144-行子查询">1.4.4 行子查询
</h3><p>子查询返回的结果是一行(可以是多列)，这种子查询称为行子查询。</p>
<p>常用的操作符：= 、&lt;&gt; 、IN 、NOT IN</p>
<p>案例：查询与&quot;韦一笑&quot;的入职日期及职位都相同的员工信息</p>
<blockquote>
<p>可以拆解为两步进行：</p>
<ol>
<li>查询 &ldquo;韦一笑&rdquo; 的入职日期 及 职位</li>
<li>查询与&quot;韦一笑&quot;的入职日期及职位相同的员工信息</li>
</ol>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 查询&#34;韦一笑&#34;的入职日期 及 职位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;韦一笑&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">#查询结果： 2007-01-01 , 2
</span></span></span><span class="line"><span class="cl"><span class="c1">-- 查询与&#34;韦一笑&#34;的入职日期及职位相同的员工信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="n">entrydate</span><span class="p">,</span><span class="n">job</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;2007-01-01&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 合并以上两条SQL语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="n">entrydate</span><span class="p">,</span><span class="n">job</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;韦一笑&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221207204452202.png" alt="image-20221207204452202"  /></p>
<h3 id="145-表子查询">1.4.5 表子查询
</h3><p>子查询返回的结果是多行多列，常作为临时表，这种子查询称为表子查询。</p>
<p>案例：查询入职日期是 &ldquo;2006-01-01&rdquo; 之后的员工信息 , 及其部门信息</p>
<blockquote>
<p>分解为两步执行：</p>
<ol>
<li>查询入职日期是 &ldquo;2006-01-01&rdquo; 之后的员工信息</li>
<li>基于查询到的员工信息，在查询对应的部门信息</li>
</ol>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;2006-01-01&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">entrydate</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="s1">&#39;2006-01-01&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221208142154263.png" alt="image-20221208142154263"  /></p>
<h2 id="15-案例">1.5 案例
</h2><p>基于之前设计的多表案例的表结构，我们来完成今天的多表查询案例需求。</p>
<p><strong>准备环境</strong></p>
<p>将资料中准备好的多表查询的数据准备的SQL脚本导入数据库中。</p>
<p><img src="/assets/image-20221208143318921.png" alt="image-20221208143318921"  /></p>
<ul>
<li>分类表：category</li>
<li>菜品表：dish</li>
<li>套餐表：setmeal</li>
<li>套餐菜品关系表：setmeal_dish</li>
</ul>
<p><img src="/assets/image-20221208143312292.png" alt="image-20221208143312292"  /></p>
<p><strong>需求实现</strong></p>
<ol>
<li>查询价格低于 10元 的菜品的名称 、价格 及其 菜品的分类名称</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="cm">/*查询技巧：
</span></span></span><span class="line"><span class="cl"><span class="cm">     明确1：查询需要用到哪些字段
</span></span></span><span class="line"><span class="cl"><span class="cm">        菜品名称、菜品价格 、 菜品分类名
</span></span></span><span class="line"><span class="cl"><span class="cm">     明确2：查询的字段分别归属于哪张表
</span></span></span><span class="line"><span class="cl"><span class="cm">        菜品表：[菜品名称、菜品价格]
</span></span></span><span class="line"><span class="cl"><span class="cm">        分类表：[分类名]
</span></span></span><span class="line"><span class="cl"><span class="cm">     明确3：如查多表，建立表与表之间的关联
</span></span></span><span class="line"><span class="cl"><span class="cm">        菜品表.caategory_id = 分类表.id
</span></span></span><span class="line"><span class="cl"><span class="cm">     其他：（其他条件、其他要求）
</span></span></span><span class="line"><span class="cl"><span class="cm">        价格 &lt; 10
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">category_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221208145036602.png" alt="image-20221208145036602"  /></p>
<ol start="2">
<li>查询所有价格在 10元(含)到50元(含)之间 且 状态为&quot;起售&quot;的菜品名称、价格及其分类名称 (即使菜品没有分类 , 也要将菜品查询出来)</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">category_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221208145432077.png" alt="image-20221208145432077"  /></p>
<ol start="3">
<li>查询每个分类下最贵的菜品, 展示出分类的名称、最贵的菜品的价格</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">price</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">category_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221208150016895.png" alt="image-20221208150016895"  /></p>
<ol start="4">
<li>查询各个分类下 菜品状态为 &ldquo;起售&rdquo; , 并且 该分类下菜品总数量大于等于3 的 分类名称</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="cm">/*查询技巧：
</span></span></span><span class="line"><span class="cl"><span class="cm">     明确1：查询需要用到哪些字段
</span></span></span><span class="line"><span class="cl"><span class="cm">        分类名称、菜品总数量
</span></span></span><span class="line"><span class="cl"><span class="cm">     明确2：查询用到的字段分别归属于哪张表
</span></span></span><span class="line"><span class="cl"><span class="cm">        分类表：[分类名]
</span></span></span><span class="line"><span class="cl"><span class="cm">        菜品表：[菜品状态]
</span></span></span><span class="line"><span class="cl"><span class="cm">     明确3：如查多表，建立表与表之间的关联
</span></span></span><span class="line"><span class="cl"><span class="cm">        菜品表.caategory_id = 分类表.id
</span></span></span><span class="line"><span class="cl"><span class="cm">     其他：（其他条件、其他要求）
</span></span></span><span class="line"><span class="cl"><span class="cm">        条件：菜品状态 = 1 (1表示起售)
</span></span></span><span class="line"><span class="cl"><span class="cm">        分组：分类名
</span></span></span><span class="line"><span class="cl"><span class="cm">        分组后条件： 总数量 &gt;= 3
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">select</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">category</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">c</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">category_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">-- 起售状态
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">name</span><span class="w">  </span><span class="c1">-- 按照分类名分组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">having</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="c1">-- 各组后筛选菜品总数据&gt;=3
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221208152107502.png" alt="image-20221208152107502"  /></p>
<ol start="5">
<li>查询出 &ldquo;商务套餐A&rdquo; 中包含了哪些菜品 （展示出套餐名称、价格, 包含的菜品名称、价格、份数）</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">select</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="p">.</span><span class="n">copies</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">from</span><span class="w"> </span><span class="n">setmeal</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">setmeal_dish</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">dish</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">where</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">.</span><span class="n">setmeal_id</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">sd</span><span class="p">.</span><span class="n">dish_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;商务套餐A&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221208152626138.png" alt="image-20221208152626138"  /></p>
<ol start="6">
<li>查询出低于菜品平均价格的菜品信息 (展示出菜品名称、菜品价格)</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 1.计算菜品平均价格
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="p">;</span><span class="w">    </span><span class="c1">-- 查询结果：37.736842
</span></span></span><span class="line"><span class="cl"><span class="c1">-- 2.查询出低于菜品平均价格的菜品信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">37</span><span class="p">.</span><span class="mi">736842</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 合并以上两条SQL语句
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="nf">avg</span><span class="p">(</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dish</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221208153051333.png" alt="image-20221208153051333"  /></p>
<h1 id="2-事务">2. 事务
</h1><p>场景：学工部整个部门解散了，该部门及部门下的员工都需要删除了。</p>
<ul>
<li>
<p>操作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 删除学工部
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">-- 删除成功
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 删除学工部的员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">-- 删除失败（操作过程中出现错误：造成删除没有成功）
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>问题：如果删除部门成功了，而删除该部门的员工时失败了，此时就造成了数据的不一致。</p>
</li>
</ul>
<p>​	要解决上述的问题，就需要通过数据库中的事务来解决。</p>
<h2 id="21-介绍">2.1 介绍
</h2><p>在实际的业务开发中，有些业务操作要多次访问数据库。一个业务要发送多条SQL语句给数据库执行。需要将多次访问数据库的操作视为一个整体来执行，要么所有的SQL语句全部执行成功。如果其中有一条SQL语句失败，就进行事务的回滚，所有的SQL语句全部执行失败。</p>
<p>简而言之：事务是一组操作的集合，它是一个不可分割的工作单位。事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p>
<p>事务作用：保证在一个事务中多次操作数据库表中数据时，要么全都成功,要么全都失败。</p>
<h2 id="22-操作">2.2 操作
</h2><p>MYSQL中有两种方式进行事务的操作：</p>
<ol>
<li>自动提交事务：即执行一条sql语句提交一次事务。（默认MySQL的事务是自动提交）</li>
<li>手动提交事务：先开启，再提交</li>
</ol>
<p>事务操作有关的SQL语句：</p>
<table>
<thead>
<tr>
<th>SQL语句</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>start transaction;  /  begin ;</td>
<td>开启手动控制事务</td>
</tr>
<tr>
<td>commit;</td>
<td>提交事务</td>
</tr>
<tr>
<td>rollback;</td>
<td>回滚事务</td>
</tr>
</tbody>
</table>
<blockquote>
<p>手动提交事务使用步骤：</p>
<ul>
<li>第1种情况：开启事务  =&gt;  执行SQL语句   =&gt;  成功  =&gt;  提交事务</li>
<li>第2种情况：开启事务  =&gt;  执行SQL语句   =&gt;  失败  =&gt;  回滚事务</li>
</ul>
</blockquote>
<p>使用事务控制删除部门和删除该部门下的员工的操作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 开启事务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">start</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 删除学工部
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_dept</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 删除学工部的员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_emp</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>上述的这组SQL语句，如果如果执行成功，则提交事务</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 提交事务 (成功时执行)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">commit</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>上述的这组SQL语句，如果如果执行失败，则回滚事务</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- 回滚事务 (出错时执行)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">rollback</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="23-四大特性">2.3 四大特性
</h2><p>面试题：事务有哪些特性？</p>
<ul>
<li>原子性（Atomicity）：事务是不可分割的最小单元，要么全部成功，要么全部失败。</li>
<li>一致性（Consistency）：事务完成时，必须使所有的数据都保持一致状态。</li>
<li>隔离性（Isolation）：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行。</li>
<li>持久性（Durability）：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</li>
</ul>
<blockquote>
<p>事务的四大特性简称为：ACID</p>
</blockquote>
<ul>
<li>
<p><strong>原子性（Atomicity）</strong> ：原子性是指事务包装的一组sql是一个不可分割的工作单元，事务中的操作要么全部成功，要么全部失败。</p>
</li>
<li>
<p><strong>一致性（Consistency）</strong>：一个事务完成之后数据都必须处于一致性状态。</p>
</li>
</ul>
<p>​		如果事务成功的完成，那么数据库的所有变化将生效。</p>
<p>​		如果事务执行出现错误，那么数据库的所有变化将会被回滚(撤销)，返回到原始状态。</p>
<ul>
<li><strong>隔离性（Isolation）</strong>：多个用户并发的访问数据库时，一个用户的事务不能被其他用户的事务干扰，多个并发的事务之间要相互隔离。</li>
</ul>
<p>​		一个事务的成功或者失败对于其他的事务是没有影响。</p>
<ul>
<li><strong>持久性（Durability）</strong>：一个事务一旦被提交或回滚，它对数据库的改变将是永久性的，哪怕数据库发生异常，重启之后数据亦然存在。</li>
</ul>
<h1 id="3-索引">3. 索引
</h1><h2 id="31-介绍">3.1 介绍
</h2><p>索引(index)：是帮助数据库高效获取数据的数据结构 。</p>
<ul>
<li>简单来讲，就是使用索引可以提高查询的效率。</li>
</ul>
<p>测试没有使用索引的查询：</p>
<p><img src="/assets/image-20221209115617429.png" alt="image-20221209115617429"  /></p>
<p>添加索引后查询：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">-- 添加索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">create</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">idx_sku_sn</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="nf">tb_sku</span><span class="w"> </span><span class="p">(</span><span class="n">sn</span><span class="p">);</span><span class="w">  </span><span class="c1">#在添加索引时，也需要消耗时间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- 查询数据（使用了索引）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_sku</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;100000003145008&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221209120107543.png" alt="image-20221209120107543"  /></p>
<p>优点：</p>
<ol>
<li>提高数据查询的效率，降低数据库的IO成本。</li>
<li>通过索引列对数据进行排序，降低数据排序的成本，降低CPU消耗。</li>
</ol>
<p>缺点：</p>
<ol>
<li>索引会占用存储空间。</li>
<li>索引大大提高了查询效率，同时却也降低了insert、update、delete的效率。</li>
</ol>
<h2 id="32-结构">3.2 结构
</h2><p>MySQL数据库支持的索引结构有很多，如：Hash索引、B+Tree索引、Full-Text索引等。</p>
<p>我们平常所说的索引，如果没有特别指明，都是指默认的 B+Tree 结构组织的索引。</p>
<p>在没有了解B+Tree结构前，我们先回顾下之前所学习的树结构：</p>
<blockquote>
<p>二叉查找树：左边的子节点比父节点小，右边的子节点比父节点大</p>
</blockquote>
<p><img src="/assets/image-20221208174135229.png" alt="image-20221208174135229"  /></p>
<blockquote>
<p>当我们向二叉查找树保存数据时，是按照从大到小(或从小到大)的顺序保存的，此时就会形成一个单向链表，搜索性能会打折扣。</p>
</blockquote>
<p><img src="/assets/image-20221208174859866.png" alt="image-20221208174859866"  /></p>
<blockquote>
<p>可以选择平衡二叉树或者是红黑树来解决上述问题。（红黑树也是一棵平衡的二叉树）</p>
</blockquote>
<p><img src="/assets/image-20221209100647867.png" alt="image-20221209100647867"  /></p>
<blockquote>
<p>但是在Mysql数据库中并没有使用二叉搜索数或二叉平衡数或红黑树来作为索引的结构。</p>
</blockquote>
<p>思考：采用二叉搜索树或者是红黑树来作为索引的结构有什么问题？</p>
<details>
    <summary>答案</summary>
    最大的问题就是在数据量大的情况下，树的层级比较深，会影响检索速度。因为不管是二叉搜索数还是红黑数，一个节点下面只能有两个子节点。此时在数据量大的情况下，就会造成数的高度比较高，树的高度一旦高了，检索速度就会降低。
</details>
<blockquote>
<p>说明：如果数据结构是红黑树，那么查询1000万条数据，根据计算树的高度大概是23左右，这样确实比之前的方式快了很多，但是如果高并发访问，那么一个用户有可能需要23次磁盘IO，那么100万用户，那么会造成效率极其低下。所以为了减少红黑树的高度，那么就得增加树的宽度，就是不再像红黑树一样每个节点只能保存一个数据，可以引入另外一种数据结构，一个节点可以保存多个数据，这样宽度就会增加从而降低树的高度。这种数据结构例如BTree就满足。</p>
</blockquote>
<p>下面我们来看看B+Tree(多路平衡搜索树)结构中如何避免这个问题：</p>
<p><img src="/assets/image-20221208181315728.png" alt="image-20221208181315728"  /></p>
<p>B+Tree结构：</p>
<ul>
<li>每一个节点，可以存储多个key（有n个key，就有n个指针）</li>
<li>节点分为：叶子节点、非叶子节点
<ul>
<li>叶子节点，就是最后一层子节点，所有的数据都存储在叶子节点上</li>
<li>非叶子节点，不是树结构最下面的节点，用于索引数据，存储的的是：key+指针</li>
</ul>
</li>
<li>为了提高范围查询效率，叶子节点形成了一个双向链表，便于数据的排序及区间范围查询</li>
</ul>
<blockquote>
<p><strong>拓展：</strong></p>
<p>非叶子节点都是由key+指针域组成的，一个key占8字节，一个指针占6字节，而一个节点总共容量是16KB，那么可以计算出一个节点可以存储的元素个数：16*1024字节 / (8+6)=1170个元素。</p>
<ul>
<li>查看mysql索引节点大小：show global status like &lsquo;innodb_page_size&rsquo;;    &ndash; 节点大小：16384</li>
</ul>
<p>当根节点中可以存储1170个元素，那么根据每个元素的地址值又会找到下面的子节点，每个子节点也会存储1170个元素，那么第二层即第二次IO的时候就会找到数据大概是：1170*1170=135W。也就是说B+Tree数据结构中只需要经历两次磁盘IO就可以找到135W条数据。</p>
<p>对于第二层每个元素有指针，那么会找到第三层，第三层由key+数据组成，假设key+数据总大小是1KB，而每个节点一共能存储16KB，所以一个第三层一个节点大概可以存储16个元素(即16条记录)。那么结合第二层每个元素通过指针域找到第三层的节点，第二层一共是135W个元素，那么第三层总元素大小就是：135W*16结果就是2000W+的元素个数。</p>
<p>结合上述分析B+Tree有如下优点：</p>
<ul>
<li>千万条数据，B+Tree可以控制在小于等于3的高度</li>
<li>所有的数据都存储在叶子节点上，并且底层已经实现了按照索引进行排序，还可以支持范围查询，叶子节点是一个双向链表，支持从小到大或者从大到小查找</li>
</ul>
</blockquote>
<h2 id="33-语法">3.3 语法
</h2><p><strong>创建索引</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">create</span><span class="w">  </span><span class="p">[</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="p">]</span><span class="w">  </span><span class="k">index</span><span class="w"> </span><span class="err">索引名</span><span class="w"> </span><span class="k">on</span><span class="w">  </span><span class="err">表名</span><span class="w"> </span><span class="p">(</span><span class="err">字段名</span><span class="p">,...</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>案例：为tb_emp表的name字段建立一个索引</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">create</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">idx_emp_name</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="nf">tb_emp</span><span class="p">(</span><span class="n">name</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221209105119159.png" alt="image-20221209105119159"  /></p>
<blockquote>
<p>在创建表时，如果添加了主键和唯一约束，就会默认创建：主键索引、唯一约束</p>
<p><img src="/assets/image-20221209105846211.png" alt="image-20221209105846211"  /></p>
</blockquote>
<p><strong>查看索引</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">show</span><span class="w">  </span><span class="k">index</span><span class="w">  </span><span class="k">from</span><span class="w">  </span><span class="err">表名</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>案例：查询 tb_emp 表的索引信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">show</span><span class="w">  </span><span class="k">index</span><span class="w">  </span><span class="k">from</span><span class="w">  </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/assets/image-20221209110317092.png" alt="image-20221209110317092"  /></p>
<p><strong>删除索引</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">drop</span><span class="w">  </span><span class="k">index</span><span class="w">  </span><span class="err">索引名</span><span class="w">  </span><span class="k">on</span><span class="w">  </span><span class="err">表名</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>案例：删除 tb_emp 表中name字段的索引</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="k">drop</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="n">idx_emp_name</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">tb_emp</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意事项：</p>
<ul>
<li>
<p>主键字段，在建表时，会自动创建主键索引</p>
</li>
<li>
<p>添加唯一约束时，数据库实际上会添加唯一索引</p>
</li>
</ul>
</blockquote>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3&#43;Aro6EYUG4&#43;cU&#43;KJWu/X"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"integrity="sha384-g7c&#43;Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI&#43;sEnkvrMWph2EDg4"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC&#43;Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>

     
     
        
    









































































wa
<script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }


     
    :root{
        --waline-theme-color: #34495e;  
        --waline-active-color: #bababa;  
        --waline-badge-color: #34495e;  
        --waline-avatar-size: 5rem;
        --waline-dark-grey: #34495e;  
    }

     
    :root[data-scheme="dark"] {
        --waline-theme-color: #acc6e0;
        --waline-white: #34495e;  
        --waline-active-color: #8ab1d8;
        --waline-light-grey: #666;
        --waline-dark-grey: #acc6e0;  
        --waline-badge-color: #acc6e0;

         
        --waline-text-color: rgba(255, 255, 255, 0.7);
        --waline-bgcolor: #515151;
        --waline-bgcolor-light: #66696b; 
        --waline-border-color: #9B9C9C;
        --waline-disable-bgcolor: #444;
        --waline-disable-color: #272727;

         
        --waline-bq-color:  #9B9C9C;  

         
        --waline-info-bgcolor: #acc6e0;
        --waline-info-color: #9B9C9C;
    }
    .waline-container[data-v-app] .wl-content .wl-emoji {
        width:3.7em;  
        height: 3.7em;

    }
</style><script>
    
    Waline.init({"dark":"auto","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis/bilibili@1.0.6"],"locale":{"admin":"博主","placeholder":"有什么新点子？（上方留下邮箱可以收到通知哦）"},"pageview":true,"requiredMeta":["name","email","url"],"visitor":true});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2024

        alwaysGreat&#39;s blog
    </section>

    <section class="powerby">
        
            2024开始使用hugo建站 || Theme Stack Design by Jimmy <br/>
         <br />
        
    </section>










  
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">目录</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#11-概述">1.1 概述</a>
      <ol>
        <li><a href="#111-数据准备">1.1.1 数据准备</a></li>
        <li><a href="#112-介绍">1.1.2 介绍</a></li>
        <li><a href="#113-分类">1.1.3 分类</a></li>
      </ol>
    </li>
    <li><a href="#12-内连接">1.2 内连接</a></li>
    <li><a href="#13-外连接">1.3 外连接</a></li>
    <li><a href="#14-子查询">1.4 子查询</a>
      <ol>
        <li><a href="#141-介绍">1.4.1 介绍</a></li>
        <li><a href="#142-标量子查询">1.4.2 标量子查询</a></li>
        <li><a href="#143-列子查询">1.4.3 列子查询</a></li>
        <li><a href="#144-行子查询">1.4.4 行子查询</a></li>
        <li><a href="#145-表子查询">1.4.5 表子查询</a></li>
      </ol>
    </li>
    <li><a href="#15-案例">1.5 案例</a></li>
  </ol>

  <ol>
    <li><a href="#21-介绍">2.1 介绍</a></li>
    <li><a href="#22-操作">2.2 操作</a></li>
    <li><a href="#23-四大特性">2.3 四大特性</a></li>
  </ol>

  <ol>
    <li><a href="#31-介绍">3.1 介绍</a></li>
    <li><a href="#32-结构">3.2 结构</a></li>
    <li><a href="#33-语法">3.3 语法</a></li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
